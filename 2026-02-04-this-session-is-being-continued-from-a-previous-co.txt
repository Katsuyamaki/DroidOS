
 ▐▛███▜▌   Claude Code v2.1.31
▝▜█████▛▘  Opus 4.5 · Claude Pro
  ▘▘ ▝▝    ~/projects/DroidOS

✻ Conversation compacted (ctrl+o for history)

  ⎿ Referenced file DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/Dr
    idOSTrackpadKeyboard/DockInputMethodService.kt
  ⎿ Read DroidOSKeyboardTrackpad/app/src/main/res/layout/layout_dock_popup.xml 
    (214 lines)
  ⎿ Referenced file DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/Dr
    idOSTrackpadKeyboard/KeyboardOverlay.kt

● I'll fix the issue where launcherTiledActive gets stuck at true after tiling
  apps, causing fullscreen app auto-resize to stop working. Let me read the
  current state of the file to implement the fix.

● Read 1 file (ctrl+o to expand)

● I see the issue. The canSoftUpdate logic relies on launcherTiledActive, but
  when transitioning from tiled to fullscreen mode, there's a timing race where
  updateInputViewHeight() might be called before the TILED_STATE broadcast
  arrives. This causes fullscreen apps to get the "soft update" path instead of
  the full setInputView() path they need.

  The fix is to track when we need a forced full update regardless of the
  current launcherTiledActive value.

● Update(DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOSTrackp
        adKeyboard/DockInputMethodService.kt)
  ⎿  (No changes)

❯ check claude.md for instructions to present code patch plan 

● FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Fix fullscreen app resize stopping after tiling - add forceFullUpdate
  flag to handle state transition timing
  SEARCH_BLOCK:
      private var launcherTiledActive = false

      private val tiledStateReceiver = object : BroadcastReceiver() {
          override fun onReceive(context: Context?, intent: Intent?) {
              val newState = intent?.getBooleanExtra("TILED_ACTIVE", false) ?:
  false
              android.util.Log.w(TAG, ">>> TILED_STATE received: $newState (was 
  $launcherTiledActive)")
              if (newState != launcherTiledActive) {
                  launcherTiledActive = newState
                  // Force the system to recompute insets with the new tiled 
  state
                  window?.window?.decorView?.requestLayout()
                  // [FIX] If switched to fullscreen, force full update to 
  recalculate insets
                  if (!newState && prefAutoResize && prefDockMode) {
                      android.util.Log.w(TAG, ">>> TILED_STATE: Switched to 
  FULLSCREEN, forcing updateInputViewHeight")
                      updateInputViewHeight()
                  }
              }
          }
      }
  REPLACE_BLOCK:
      private var launcherTiledActive = false
      private var forceFullUpdate = false // Flag to force full setInputView() 
  on next update

      private val tiledStateReceiver = object : BroadcastReceiver() {
          override fun onReceive(context: Context?, intent: Intent?) {
              val newState = intent?.getBooleanExtra("TILED_ACTIVE", false) ?:
  false
              android.util.Log.w(TAG, ">>> TILED_STATE received: $newState (was 
  $launcherTiledActive)")
              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
                  // Force the system to recompute insets with the new tiled 
  state
                  window?.window?.decorView?.requestLayout()
                  // If switched to fullscreen, set flag to force full update
                  if (wasTransitionToFullscreen && prefAutoResize &&
  prefDockMode) {
                      android.util.Log.w(TAG, ">>> TILED_STATE: Switched to 
  FULLSCREEN, setting forceFullUpdate flag")
                      forceFullUpdate = true
                      updateInputViewHeight()
                  }
              }
          }
      }
  END_OF_UPDATE_BLOCK

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Use forceFullUpdate flag in canSoftUpdate check and clear it after
  full update
  SEARCH_BLOCK:
              val existingWrapper = currentInputWrapper
              val canSoftUpdate = existingWrapper != null &&
                  existingWrapper.parent != null &&
                  isInputViewShown &&
                  lastCalculatedHeight > 0 &&
                  launcherTiledActive // Only soft update for tiled apps

              if (canSoftUpdate) {
  REPLACE_BLOCK:
              val existingWrapper = currentInputWrapper
              val canSoftUpdate = existingWrapper != null &&
                  existingWrapper.parent != null &&
                  isInputViewShown &&
                  lastCalculatedHeight > 0 &&
                  launcherTiledActive && // Only soft update for tiled apps
                  !forceFullUpdate // Respect forced full update flag

              if (canSoftUpdate) {
  END_OF_UPDATE_BLOCK

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Clear forceFullUpdate flag after performing full setInputView()
  SEARCH_BLOCK:
              } else {
                  // First time, wrapper not attached, OR fullscreen app - do 
  full setInputView()
                  val wrapper = createInputViewWrapper(correctedHeight)
                  currentInputWrapper = wrapper
                  lastCalculatedHeight = correctedHeight
                  setInputView(wrapper)
                  android.util.Log.d(TAG, "updateInputViewHeight: FULL UPDATE 
  (setInputView) h=$correctedHeight fullscreen=${!launcherTiledActive}")
              }
  REPLACE_BLOCK:
              } else {
                  // First time, wrapper not attached, OR fullscreen app - do 
  full setInputView()
                  val wrapper = createInputViewWrapper(correctedHeight)
                  currentInputWrapper = wrapper
                  lastCalculatedHeight = correctedHeight
                  forceFullUpdate = false // Clear flag after full update
                  setInputView(wrapper)
                  android.util.Log.d(TAG, "updateInputViewHeight: FULL UPDATE 
  (setInputView) h=$correctedHeight fullscreen=${!launcherTiledActive}")
              }
  END_OF_UPDATE_BLOCK

❯ /copy 
  ⎿  Copied to clipboard (4883 characters, 102 lines)

❯ seems to be fixed now. can you update the automargin % formula or the     
  stretxh keyboard height to marfin logic? one of these is incorrect        
  because therejs always edtea space above.the keyboard and the bottom of   
  the app. thr blank space is about equal to the hekfht of the ime kb       
  toolbar. i thjnk it is likely thr margin % calculation formula js wrong   
  our double counting for the ime toolbar height twice                      

● Let me check both the IME height calculation and the overlay keyboard resize
  logic to find where the double-counting is happening.

● Searched for 2 patterns, read 1 file (ctrl+o to expand)

● I see the issue. Looking at both calculations:

  DockIME (updateInputViewHeight):
  val marginHeight = (screenHeight * (prefResizeScale / 100f)).toInt()
  val correctedHeight = (marginHeight - navHeight - 2).coerceAtLeast(0)
  // Wrapper has: toolbar(40dp) at bottom, clear space = correctedHeight - 40dp

  OverlayService (applyDockModeWithMargin):
  val marginHeight = (screenHeight * (marginPercent / 100f)).toInt()
  val kbHeight = (marginHeight - dockToolbarHeight).coerceAtLeast(...)

  The overlay doesn't account for navHeight that DockIME subtracts. The
  DockIME's clear space above toolbar is marginHeight - navHeight - 40dp, but
  the overlay sizes itself as marginHeight - 40dp. The difference = navHeight ≈
  40dp on most devices.

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/OverlayService.kt
  REASON: Fix overlay keyboard height to account for nav bar (match DockIME
  calculation)
  SEARCH_BLOCK:
      private fun applyDockModeWithMargin(marginPercent: Int) {
          if (keyboardOverlay == null) initCustomKeyboard()
          if (!isCustomKeyboardVisible) {
              keyboardOverlay?.show()
              isCustomKeyboardVisible = true
          }

          val density = resources.displayMetrics.density
          val screenWidth = uiScreenWidth
          val screenHeight = uiScreenHeight

          // Calculate keyboard height from margin percentage
          // Only account for dock toolbar if it's enabled AND DockIME is 
  actually visible
          val dockToolbarHeight = if (prefs.prefShowKBAboveDock &&
  isDockIMEVisible) (40 * density).toInt() else 0
          val marginHeight = (screenHeight * (marginPercent / 100f)).toInt()
          val kbHeight = (marginHeight - dockToolbarHeight).coerceAtLeast((90 *
  density).toInt()) // Min 90dp

          // Position at bottom (above dock toolbar only if it's visible)
          val targetW = screenWidth
          val targetY = screenHeight - kbHeight - dockToolbarHeight
  REPLACE_BLOCK:
      private fun applyDockModeWithMargin(marginPercent: Int) {
          if (keyboardOverlay == null) initCustomKeyboard()
          if (!isCustomKeyboardVisible) {
              keyboardOverlay?.show()
              isCustomKeyboardVisible = true
          }

          val density = resources.displayMetrics.density
          val screenWidth = uiScreenWidth
          val screenHeight = uiScreenHeight

          // Get nav bar height to match DockIME's calculation
          val wm = getSystemService(Context.WINDOW_SERVICE) as
  android.view.WindowManager
          val windowMetrics = wm.currentWindowMetrics
          val navInsets =
  windowMetrics.windowInsets.getInsetsIgnoringVisibility(
              android.view.WindowInsets.Type.navigationBars()
          )
          val navHeight = navInsets.bottom

          // Calculate keyboard height from margin percentage
          // Must match DockIME's formula: marginHeight - navHeight - 
  toolbarHeight
          // Only account for dock toolbar if it's enabled AND DockIME is 
  actually visible
          val dockToolbarHeight = if (prefs.prefShowKBAboveDock &&
  isDockIMEVisible) (40 * density).toInt() else 0
          val marginHeight = (screenHeight * (marginPercent / 100f)).toInt()
          val kbHeight = (marginHeight - navHeight -
  dockToolbarHeight).coerceAtLeast((90 * density).toInt()) // Min 90dp

          // Position at bottom (above dock toolbar and nav bar)
          val targetW = screenWidth
          val targetY = screenHeight - navHeight - kbHeight - dockToolbarHeight
  END_OF_UPDATE_BLOCK

✻ Cogitated for 3m 3s

❯ /copy 
  ⎿  Copied to clipboard (3607 characters, 75 lines)

❯ it didntwoek. tilednpps had double the extra spacw now and didnt notice a 
   difference for full scren apps. then i noticed full screen apps auto     
  margin adjust stopped working so i git eestored. But now when i it        
  restored, full screen appz still dont auto resize! it was definitly       
  working before on this code                                               

● Let me check the current state of the files and git status.

● Bash(git status && git diff DroidOSKeyboardTrackpad/app/src/main/java/com/kats
      uyamaki/DroidOSTrackpadKeyboard/DockInputMethodService.kt)
  ⎿  On branch main
     Your branch is ahead of 'origin/main' by 10 commits.
       (use "git push" to publish your local commits)
     … +2 lines (ctrl+o to expand)

● Bash(git log --oneline -5)
  ⎿ 7c1e6c1 * Trackpad: DockInputMethodService.kt: Fix fullscreen app resiz
    e stopping after tiling - add forceFullUpdate flag to handle state tran
    sition timing * Trackpad: DockInputMethodService.kt: Use forceFullUpdat
    … +51 lines (ctrl+o to expand)




● Searched for 1 pattern (ctrl+o to expand)

● The forceFullUpdate code is there. The issue might be that the app needs to be
   rebuilt after git restore. Did you rebuild and reinstall the keyboard app
  after restoring?

  Let me also verify the canSoftUpdate logic is correct:

● Read 1 file (ctrl+o to expand)

● The code looks correct. Since you git restored and the working tree is clean,
  you need to rebuild and reinstall the keyboard app to get the restored code
  running on the device.

  The device is still running the old APK with my broken nav bar patch. Run:

  cd DroidOSKeyboardTrackpad && ./gradlew assembleDebug && adb install -r
  app/build/outputs/apk/debug/app-debug.apk

  Or however you normally build/install the app.

❯ yes i rebuilt. i tried agan to git restore.and build both trackpad and    
  keyboard but srill no auto adjust margin for full screen apps             

● Let me check if there's an issue with the TILED_STATE broadcast receiver. Can
  you check logcat for the relevant logs?

  adb logcat -s DockIME:* | grep -E
  "(TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE)"

  Also let me verify the receiver registration is correct:

● Read 1 file (ctrl+o to expand)

● Can you run this to see what's happening in real-time when you focus a text
  field in a fullscreen app:

  adb logcat -s DockIME:* 2>&1 | grep -E
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT UPDATE"

  This will show us:
  1. If TILED_STATE broadcasts are received
  2. Whether it's doing FULL UPDATE or SOFT UPDATE
  3. What the onComputeInsets values are

  Also - just to confirm: after you restart the keyboard app (force stop and
  reopen), do fullscreen apps work for a bit before they stop working? Or do
  they not work at all even after a fresh restart?

✻ Brewed for 35s

❯ it doesnt work at all anymkre, not even after an app restart. okay well   
  now it works when i use the logcat... weird... ill have to kep monitoring 
   it... but here are the logs. can try to rix the extra space issue again  
  while i keep monitoring for full screen app auto margjn breaking          
  ~/projects/DroidOS main ⇡ 20s ❯ adb logcat -c && adb logcat -s DockIME:*  
  2>&1 | grep -E "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL    
  UPDATE|SOFT UPDATE"                                                       
  02-04 07:39:25.199 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:39:25.461 19644 19644 W DockIME 
   : >>> TILED_STATE received: false (was false)                            
  02-04 07:39:25.715 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:39:25.722 19644 19644 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  07:39:27.381 19644 19644 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:27.381 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 07:39:27.386 19644 19644 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 07:39:27.386 19644 19644 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 07:39:27.454 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:39:27.454 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:39:27.496 19644 19644 W DockIME : >>> TILED_STATE received:      
  false (was false)                                                         
  02-04 07:39:27.497 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:39:27.497 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:39:28.122 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:28.639 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:28.645 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:28.936 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:28.937 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:39:28.947 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:39:28.947 19644      
  19644 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 07:39:29.011 19644 19644 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:39:29.011 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:39:30.215 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:30.215 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 07:39:30.277 19644 19644 W        
  DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,             
  dockView=true)                                                            
            02-04 07:39:30.794 19644 19644 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
  02-04 07:39:31.524 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:31.525 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:39:31.530 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:39:31.530 19644      
  19644 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 07:39:33.966 19644 19644 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
  02-04 07:39:34.488 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:39:34.751 19644 19644 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 07:39:34.752 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:39:34.773 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:39:34.773 19644      
  19644 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
  02-04 07:39:34.846 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:34.847 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:39:34.879 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:39:34.879 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:39:35.927 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:35.928 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:39:35.990 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:39:35.990 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:39:36.041 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:36.552 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:37.651 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:39:37.652 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:39:37.661 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:39:37.661 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:39:40.334 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:40.862 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:39:44.548 19644 19644 W DockIME 
   : >>> TILED_STATE received: true (was false)                             
  02-04 07:39:44.557 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:39:45.362 19644 19644 W DockIME : >>> TILED_STATE received: true 
   (was true)                                                               
  02-04 07:39:45.931 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 07:39:45.931 19644 19644 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
  02-04 07:39:45.936 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 07:39:45.937 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 07:39:45.988 19644 19644 W       
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
  02-04 07:39:45.988 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 07:39:46.031 19644 19644 W       
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 07:39:46.031 19644 19644 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
  02-04 07:39:49.901 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:39:49.901 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:39:49.958 19644 19644 W DockIME : >>> onComputeInsets:  
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 07:39:49.959 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 07:39:50.059 19644 19644 W       
  DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,             
  dockView=true)                                                            
            02-04 07:39:50.583 19644 19644 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
  02-04 07:39:51.019 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
                                     02-04 07:39:51.019 19644 19644 D       
  DockIME : updateInputViewHeight: SOFT UPDATE (tiled) h=603                
                                                                            
  02-04 07:39:51.026 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 07:39:51.026 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 07:39:51.165 19644 19644 W       
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 07:39:51.165 19644 19644 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
                                                            02-04           
  07:39:51.182 19644 19644 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
                                     02-04 07:39:51.182 19644 19644 D       
  DockIME : updateInputViewHeight: SOFT UPDATE (tiled) h=603                
                                                                            
  02-04 07:39:51.184 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:39:51.184 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:39:53.967 19644 19644 W DockIME : >>> onComputeInsets:  
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:39:53.967 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:39:53.981 19644 19644 W DockIME : >>> onComputeInsets:  
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:39:53.981 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:39:54.019 19644 19644 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=true                                                                
  02-04 07:39:54.019 19644 19644 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
                                    02-04 07:39:54.096 19644 19644 W        
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 07:39:54.096 19644 19644 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
  02-04 07:39:55.866 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:39:56.398 19644 19644 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  07:39:56.527 19644 19644 W DockIME : >>> TILED_STATE received: true (was  
  true)                                                                     
  02-04 07:40:01.037 19644 19644 W DockIME : >>> TILED_STATE received:      
  false (was true)    02-04 07:40:01.037 19644 19644 W DockIME : >>>        
  TILED_STATE: Switched to FULLSCREEN, setting forceFullUpdate flag         
  02-04 07:40:01.038 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 07:40:01.038 19644 19644 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 07:40:01.042 19644 19644 W DockIME : >>> onComputeInsets:     
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 07:40:03.891 19644 19644 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
           02-04 07:40:03.892 19644 19644 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  07:40:03.901 19644 19644 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 07:40:03.901 19644 19644 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  07:40:03.967 19644 19644 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 07:40:03.967 19644 19644 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  07:40:06.146 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:40:06.661 19644 19644 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
  02-04 07:40:07.730 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 07:40:07.731 19644 19644 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 07:40:07.742 19644 19644 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:40:07.742 19644      
  19644 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 07:40:11.542 19644 19644 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
  02-04 07:40:12.059 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:40:13.380 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 07:40:13.381 19644 19644 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
  02-04 07:40:13.388 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:40:13.388 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:40:15.289 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:40:15.392 19644 19644 W DockIME : >>> TILED_STATE received:      
  false (was false)                                                         
  02-04 07:40:15.409 19644 19644 W DockIME : >>> TILED_STATE received:      
  false (was false)                                                         
  02-04 07:40:15.803 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:40:19.383 19644 19644 W DockIME 
   : >>> TILED_STATE received: false (was false)                            
  02-04 07:40:29.456 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:40:29.459 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:40:29.470 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:40:29.470 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:40:31.597 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:40:32.112 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:40:39.656 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:40:39.656 19644 19644 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:40:39.661 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:40:39.661 19644 19644 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 07:40:39.670 19644 19644 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
           02-04 07:40:39.670 19644 19644 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
  02-04 07:40:39.720 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:40:39.720 19644      
  19644 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 07:40:39.808 19644 19644 W DockIME : >>> TILED_STATE       
  received: true (was false)    02-04 07:40:39.862 19644 19644 W DockIME :  
  >>> onComputeInsets: tiled=true, autoResize=true, dockMode=true,          
  viewH=628, wrapperH=603, lastCalcH=603                                    
  02-04 07:40:39.862 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 07:40:39.875 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:40:39.875 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:40:40.804 19644 19644 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
  02-04 07:40:41.314 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:40:41.315 19644 19644 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  07:40:43.086 19644 19644 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 07:40:43.088 19644 19644 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
                                    02-04 07:40:43.097 19644 19644 W        
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 07:40:43.097 19644 19644 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
                                                            02-04           
  07:40:43.178 19644 19644 W DockIME : >>> onComputeInsets: tiled=true,     
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                               02-04 07:40:43.178 19644 19644 W DockIME :   
  >>> onComputeInsets: TILED MODE - suppressing insets (contentTop=628)     
                                                                02-04       
  07:40:43.223 19644 19644 W DockIME : >>> onComputeInsets: tiled=true,     
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                               02-04 07:40:43.223 19644 19644 W DockIME :   
  >>> onComputeInsets: TILED MODE - suppressing insets (contentTop=628)     
                                                                ^C          
  ~/projects/DroidOS main ⇡ 1m 22s ❯                                        

● The logs show it's working now. Interesting that it was intermittent.

  Looking at the logs for the extra space issue:
  - Margin=630, Nav=25, IME Height=603
  - The nav bar is only 25px (gesture nav), so that's not causing the ~40dp gap

  The issue is likely the calculation mismatch. In DockIME:
  - wrapper height = marginHeight - navHeight - 2 = 630 - 25 - 2 = 603
  - toolbar inside = ~105px (40dp)
  - clear space = 603 - 105 = 498px

  But the overlay calculates:
  - kbHeight = marginHeight - toolbar = 630 - 105 = 525px

  The overlay keyboard (525px) is bigger than the DockIME clear space (498px) by
   27px. But you said the gap is ~40dp, which suggests something else.

  Let me try a different approach - remove the navHeight subtraction from
  DockIME so both calculations match:

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Remove navHeight subtraction so IME wrapper matches overlay
  calculation
  SEARCH_BLOCK:
              // 4. Calculate IME Window Height
              // Subtract nav height because IME sits ON TOP of nav bar, while 
  margin is from physical bottom.
              // [FIX] Subtract extra 2px safety buffer to handle rounding 
  errors and ensure
              // the IME window stays strictly below the Launcher's tiling line.
              val correctedHeight = (marginHeight - navHeight -
  2).coerceAtLeast(0)
  REPLACE_BLOCK:
              // 4. Calculate IME Window Height
              // Don't subtract nav height - let the wrapper match the full 
  margin height
              // so fullscreen apps resize correctly to match the overlay 
  keyboard position.
              // The 2px buffer handles rounding errors.
              val correctedHeight = (marginHeight - 2).coerceAtLeast(0)
  END_OF_UPDATE_BLOCK

✻ Baked for 1m 20s

❯ /copy 
  ⎿  Copied to clipboard (1805 characters, 37 lines)

❯ i didnt apply that lasy patch llan yet. but termux full screen stopled    
  automargin resizing. see logs attached ~/projects/DroidOS main ⇡ 1m 22s ❯ 
   adb logcat -c && adb logcat -s DockIME:* 2>&1 | grep -E                  
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT       
  UPDATE"            02-04 07:44:03.143 19644 19644 D DockIME :             
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=true                                                                
  02-04 07:44:03.143 19644 19644 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
  02-04 07:44:03.151 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:44:03.151 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:44:03.256 19644 19644 W DockIME : >>> onComputeInsets:  
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 07:44:03.256 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 07:44:09.213 19644 19644 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:44:09.641 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 07:44:09.641 19644 19644 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
  02-04 07:44:09.642 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 07:44:09.642 19644 19644 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 07:44:12.024 19644 19644 W       
  DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,             
  dockView=true)                                                            
            02-04 07:44:12.538 19644 19644 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
  02-04 07:44:13.581 19644 19644 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
                                     02-04 07:44:13.581 19644 19644 D       
  DockIME : updateInputViewHeight: SOFT UPDATE (tiled) h=603                
                                                                            
  02-04 07:44:13.591 19644 19644 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:44:13.591 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:44:13.685 19644 19644 W DockIME : >>> onComputeInsets:  
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 07:44:13.685 19644     
  19644 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 07:44:16.013 19644 19644 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 07:44:16.535 19644 19644 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            ^C                                                              
                            ~/projects/DroidOS main ⇡ 20s ❯                 

● The problem is clear from the logs - tiled=true is stuck even though Termux is
   fullscreen. No TILED_STATE broadcast was received to change it to false.

  The issue: launcherTiledActive stays true from previous tiled session, and the
   Launcher isn't sending a TILED_STATE=false broadcast when Termux (fullscreen)
   gets focus.

  Quick fix: Reset launcherTiledActive to false on onWindowShown() - assume
  fullscreen by default, let the TILED_STATE broadcast override if actually
  tiled.

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Reset launcherTiledActive to false on window show - assume fullscreen
  by default
  SEARCH_BLOCK:
      override fun onWindowShown() {
          super.onWindowShown()
          loadDockPrefs()

          android.util.Log.w(TAG, ">>> onWindowShown: 
  tiled=$launcherTiledActive, autoResize=$prefAutoResize, 
  dockMode=$prefDockMode, scale=$prefResizeScale")
  REPLACE_BLOCK:
      override fun onWindowShown() {
          super.onWindowShown()
          loadDockPrefs()

          // [FIX] Reset to fullscreen by default on every window show.
          // If the app is actually tiled, the TILED_STATE broadcast will arrive
   shortly
          // and override this. This prevents stale tiled=true state from 
  blocking
          // fullscreen app resizing.
          val wasTiled = launcherTiledActive
          launcherTiledActive = false
          forceFullUpdate = wasTiled // Force full update if we were previously 
  tiled

          android.util.Log.w(TAG, ">>> onWindowShown: tiled=$launcherTiledActive
   (was $wasTiled), autoResize=$prefAutoResize, dockMode=$prefDockMode, 
  scale=$prefResizeScale")
  END_OF_UPDATE_BLOCK

❯ /copy 
  ⎿  Copied to clipboard (1751 characters, 33 lines)

❯ its still tempermental. it works,.doesmt work. then works again. see tbe  
  log ~/projects/DroidOS main ⇡ 1m 2s ❯ adb logcat -c && adb logcat -s      
  DockIME:* 2>&1 | grep -E                                                  
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT       
  UPDATE"             02-04 07:51:22.755 24282 24282 D DockIME :            
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 07:51:22.756 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:51:22.827 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:51:22.875 24282 24282 W DockIME 
   : >>> TILED_STATE received: true (was false)                             
  02-04 07:51:22.879 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:51:23.343 24282 24282 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  07:51:23.345 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 07:51:26.374 24282 24282 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 07:51:26.375 24282 24282 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
  02-04 07:51:26.385 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:51:26.385 24282 24282 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 07:51:27.863 24282 24282 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 07:51:28.390 24282 24282 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 07:51:28.626 24282 24282  
  D DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME          
  Height=603, tiled=false                                                   
           02-04 07:51:28.626 24282 24282 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  07:51:28.635 24282 24282 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 07:51:28.635 24282 24282 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
  02-04 07:51:29.887 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:51:30.401 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 07:51:32.169 24282 24282 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:51:32.170 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:51:32.174 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:51:32.174 24282 24282 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 07:51:32.237 24282 24282 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
  02-04 07:51:32.237 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:51:32.238 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:51:32.238 24282 24282 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 07:51:32.343 24282 24282 W DockIME : >>> TILED_STATE received: true 
   (was false)                                                              
  02-04 07:51:32.375 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 07:51:32.376 24282 24282 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 07:51:33.434 24282 24282 W       
  DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,             
  dockView=true)                                                            
            02-04 07:51:33.949 24282 24282 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 07:51:34.097 24282 24282  
  W DockIME : >>> TILED_STATE received: true (was true)     02-04           
  07:51:38.102 24282 24282 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:51:38.102 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 07:51:38.107 24282 24282 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 07:51:38.107 24282 24282 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 07:51:38.222 24282 24282 W DockIME : >>> TILED_STATE received: true 
   (was false)    02-04 07:51:38.224 24282 24282 W DockIME : >>>            
  onComputeInsets: tiled=true, autoResize=true, dockMode=true, viewH=628,   
  wrapperH=603, lastCalcH=603                                02-04          
  07:51:38.224 24282 24282 W DockIME : >>> onComputeInsets: TILED MODE -    
  suppressing insets (contentTop=628)                                       
                              02-04 07:51:38.850 24282 24282 W DockIME :    
  >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)        
                                                                02-04       
  07:51:39.367 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 07:51:40.836 24282 24282 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 07:51:40.836 24282 24282 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 07:51:40.844 24282 24282 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 07:51:40.844 24282 24282 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 07:51:40.926 24282 24282 W 
   DockIME : >>> onComputeInsets: tiled=false, autoResize=true,             
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 07:51:40.926 24282 24282 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  07:51:43.021 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 07:51:43.549 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:51:43.781 24282 24282 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 07:51:43.782 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:51:43.791 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:51:43.792 24282      
  24282 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 07:51:45.310 24282 24282 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 07:51:45.831 24282 24282 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 07:51:48.007 24282 24282 D DockIME :                      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 07:51:48.008 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 07:51:48.015 24282 24282 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 07:51:48.015 24282 24282 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  07:51:51.940 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:51:52.452 24282 24282 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  07:51:55.939 24282 24282 W DockIME : >>> TILED_STATE received: false (was 
   false)   02-04 07:51:56.953 24282 24282 D DockIME :                      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 07:51:56.953 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 07:51:56.961 24282 24282 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
  02-04 07:51:56.961 24282 24282 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 07:51:56.999 24282 24282 W 
   DockIME : >>> onComputeInsets: tiled=false, autoResize=true,             
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 07:51:56.999 24282 24282 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 07:51:57.858 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:51:58.367 24282 24282 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  07:52:02.606 24282 24282 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 07:52:02.607 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 07:52:02.614 24282 24282 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 07:52:02.614 24282 24282 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 07:52:02.732 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:52:02.732 24282      
  24282 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 07:52:04.545 24282 24282 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
  02-04 07:52:05.063 24282 24282 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 07:52:20.618 24282 24282 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 07:52:20.619 24282 24282 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 07:52:20.627 24282 24282 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 07:52:20.627 24282      
  24282 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           ^C                                                               
                           ~/projects/DroidOS main ⇡ 1m 5s ❯                

● I see the problem now. The Launcher sends TILED_STATE=true AFTER the FULL
  UPDATE happens, which then switches onComputeInsets to TILED MODE mid-stream,
  breaking the resize.

  The fix: Lock the tiled state when IME is visible - don't accept TILED_STATE
  changes while the keyboard is shown. Only update when hidden.

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Lock tiled state while IME is visible - ignore TILED_STATE broadcasts
  during active input
  SEARCH_BLOCK:
      private val tiledStateReceiver = object : BroadcastReceiver() {
          override fun onReceive(context: Context?, intent: Intent?) {
              val newState = intent?.getBooleanExtra("TILED_ACTIVE", false) ?:
  false
              android.util.Log.w(TAG, ">>> TILED_STATE received: $newState (was 
  $launcherTiledActive)")
              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
                  // Force the system to recompute insets with the new tiled 
  state
                  window?.window?.decorView?.requestLayout()
                  // If switched to fullscreen, set flag to force full update
                  if (wasTransitionToFullscreen && prefAutoResize &&
  prefDockMode) {
                      android.util.Log.w(TAG, ">>> TILED_STATE: Switched to 
  FULLSCREEN, setting forceFullUpdate flag")
                      forceFullUpdate = true
                      updateInputViewHeight()
                  }
              }
          }
      }
  REPLACE_BLOCK:
      private val tiledStateReceiver = object : BroadcastReceiver() {
          override fun onReceive(context: Context?, intent: Intent?) {
              val newState = intent?.getBooleanExtra("TILED_ACTIVE", false) ?:
  false
              android.util.Log.w(TAG, ">>> TILED_STATE received: $newState (was 
  $launcherTiledActive, inputShown=$isInputViewShown)")

              // [FIX] Don't change tiled state while IME is visible - this 
  prevents
              // race conditions where TILED_STATE=true arrives after we've 
  already
              // set up fullscreen insets, breaking the app resize.
              // Only accept state changes when IME is hidden.
              if (isInputViewShown) {
                  android.util.Log.w(TAG, ">>> TILED_STATE: IGNORED (IME 
  visible, state locked)")
                  return
              }

              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
                  // Force the system to recompute insets with the new tiled 
  state
                  window?.window?.decorView?.requestLayout()
                  // If switched to fullscreen, set flag to force full update
                  if (wasTransitionToFullscreen && prefAutoResize &&
  prefDockMode) {
                      android.util.Log.w(TAG, ">>> TILED_STATE: Switched to 
  FULLSCREEN, setting forceFullUpdate flag")
                      forceFullUpdate = true
                      updateInputViewHeight()
                  }
              }
          }
      }
  END_OF_UPDATE_BLOCK

❯ /copy 
  ⎿  Copied to clipboard (3234 characters, 59 lines)

❯ i think it js working for full screen apps but tiled apls are broken now  
  wjth auto resize marfjn ~/projects/DroidOS main ⇡ 26s ❯ adb logcat -c &&  
  adb logcat -s DockIME:* 2>&1 | grep -E                                    
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT       
  UPDATE"               02-04 08:00:15.254  8261  8261 W DockIME : >>>      
  onComputeInsets: tiled=false, autoResize=true, dockMode=true, viewH=628,  
  wrapperH=603, lastCalcH=603                                               
  02-04 08:00:15.254  8261  8261 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:00:15.274  8261  8261 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
           02-04 08:00:15.275  8261  8261 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
  02-04 08:00:15.352  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:00:15.352  8261  8261 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:00:15.399  8261  8261 W DockIME : >>> TILED_STATE received: true 
   (was false, inputShown=false)                                            
  02-04 08:00:15.401  8261  8261 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:00:15.922  8261  8261 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:00:18.121  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:00:18.121  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:00:18.130  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:18.130  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
  02-04 08:00:18.256  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:00:18.256  8261  8261 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:00:18.294  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:00:18.294  8261  8261 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:00:18.392  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:00:18.393  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:00:18.468  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:18.468  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
  02-04 08:00:20.750  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:00:20.751  8261  8261 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:00:20.762  8261  8261 W DockIME : >>> onComputeInsets:     
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:00:21.281  8261  8261 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:00:21.282  8261  8261 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 08:00:23.481  8261  8261  
  D DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME          
  Height=603, tiled=false                                                   
           02-04 08:00:23.482  8261  8261 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  08:00:23.489  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:00:23.489  8261  8261 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:00:23.563  8261  8261 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:00:23.563  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:23.602  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:23.602  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 08:00:23.774  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:00:23.774  8261  8261 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:00:23.775  8261  8261 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:23.775  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
           02-04 08:00:23.849  8261  8261 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:00:23.849  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:23.883  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:23.883  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:00:25.545  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:00:25.545  8261  8261 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
  02-04 08:00:25.603  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:25.603  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
  02-04 08:00:25.710  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:00:25.710  8261  8261 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:00:25.773  8261  8261 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:25.773  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
           02-04 08:00:25.816  8261  8261 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:00:26.333  8261  8261 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:00:26.336  8261  8261 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 08:00:29.527  8261  8261  
  D DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME          
  Height=603, tiled=false                                                   
           02-04 08:00:29.527  8261  8261 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  08:00:29.533  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
  02-04 08:00:29.533  8261  8261 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:00:29.649  8261  8261 W 
   DockIME : >>> onComputeInsets: tiled=false, autoResize=true,             
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:29.649  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 08:00:29.733  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:29.733  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
           02-04 08:00:29.753  8261  8261 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:00:29.753  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:29.758  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:29.758  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 08:00:31.486  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:00:31.486  8261  8261 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:00:31.492  8261  8261 W DockIME : >>> onComputeInsets:     
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:00:32.018  8261  8261 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:00:32.023  8261  8261 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 08:00:35.943  8261  8261  
  D DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME          
  Height=603, tiled=false                                                   
           02-04 08:00:35.943  8261  8261 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  08:00:35.949  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:00:35.949  8261  8261 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
  02-04 08:00:35.959  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:00:35.959  8261  8261 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:00:36.058  8261  8261 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:36.058  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
           02-04 08:00:36.191  8261  8261 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:00:36.192  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:36.257  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:36.257  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:00:36.303  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:00:36.303  8261  8261 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
  02-04 08:00:37.878  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:37.878  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
  02-04 08:00:37.901  8261  8261 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:00:37.902  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:37.977  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:37.977  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:00:38.165  8261  8261 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=true)                                                   
  02-04 08:00:38.165  8261  8261 W DockIME : >>> TILED_STATE: IGNORED (IME  
  visible, state locked)                                                    
                                  02-04 08:00:43.706  8261  8261 W DockIME  
  : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)      
                                                                  02-04     
  08:00:44.223  8261  8261 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:00:44.816  8261  8261 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 08:00:44.816  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:00:44.824  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:44.824  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
           02-04 08:00:44.890  8261  8261 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:00:44.891  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:44.891  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:44.891  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:00:44.983  8261  8261 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=true)                                                   
                            02-04 08:00:44.983  8261  8261 W DockIME : >>>  
  TILED_STATE: IGNORED (IME visible, state locked)                          
                                                            02-04           
  08:00:44.984  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
  02-04 08:00:44.984  8261  8261 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:00:45.040  8261  8261 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
           02-04 08:00:45.040  8261  8261 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  08:00:45.043  8261  8261 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:00:45.043  8261  8261 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:00:45.050  8261  8261 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:00:45.050  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:45.102  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:45.102  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 08:00:45.197  8261  8261 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:00:45.654  8261  8261 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:00:45.661  8261  8261 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 08:00:54.795  8261  8261 W DockIME : >>> TILED_STATE received: true 
   (was false, inputShown=false)                                            
                                  02-04 08:00:54.802  8261  8261 W DockIME  
  : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)      
                                                                  02-04     
  08:00:54.990  8261  8261 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:00:54.991  8261  8261 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:00:54.998  8261  8261 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:00:54.998  8261  8261 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
  02-04 08:00:55.070  8261  8261 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:00:55.070  8261      
  8261 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default     
  insets (wrapper=603)                                                      
           ^C                                                               
                           ~/projects/DroidOS main ⇡ 44s ❯                  

● I see the issue. We're now blocking ALL TILED_STATE updates while IME is
  visible, including the legitimate tiled=true for tiled apps. We need to be
  smarter - only block transitions that would break things.

  The fix: Only ignore TILED_STATE=true when we're already in fullscreen mode
  (trying to switch to tiled mid-session). Allow TILED_STATE=true when it
  arrives early to set up tiled mode correctly.

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Only ignore tiled state changes that would break fullscreen - allow
  setting tiled=true for tiled apps
  SEARCH_BLOCK:
      private val tiledStateReceiver = object : BroadcastReceiver() {
          override fun onReceive(context: Context?, intent: Intent?) {
              val newState = intent?.getBooleanExtra("TILED_ACTIVE", false) ?:
  false
              android.util.Log.w(TAG, ">>> TILED_STATE received: $newState (was 
  $launcherTiledActive, inputShown=$isInputViewShown)")

              // [FIX] Don't change tiled state while IME is visible - this 
  prevents
              // race conditions where TILED_STATE=true arrives after we've 
  already
              // set up fullscreen insets, breaking the app resize.
              // Only accept state changes when IME is hidden.
              if (isInputViewShown) {
                  android.util.Log.w(TAG, ">>> TILED_STATE: IGNORED (IME 
  visible, state locked)")
                  return
              }

              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
                  // Force the system to recompute insets with the new tiled 
  state
                  window?.window?.decorView?.requestLayout()
                  // If switched to fullscreen, set flag to force full update
                  if (wasTransitionToFullscreen && prefAutoResize &&
  prefDockMode) {
                      android.util.Log.w(TAG, ">>> TILED_STATE: Switched to 
  FULLSCREEN, setting forceFullUpdate flag")
                      forceFullUpdate = true
                      updateInputViewHeight()
                  }
              }
          }
      }
  REPLACE_BLOCK:
      private val tiledStateReceiver = object : BroadcastReceiver() {
          override fun onReceive(context: Context?, intent: Intent?) {
              val newState = intent?.getBooleanExtra("TILED_ACTIVE", false) ?:
  false
              android.util.Log.w(TAG, ">>> TILED_STATE received: $newState (was 
  $launcherTiledActive, inputShown=$isInputViewShown)")

              // [FIX] When IME is visible, only ignore state changes that would
   break
              // fullscreen app resizing. Specifically:
              // - Allow tiled=true to come in (for tiled apps)
              // - Block tiled=true if we already set up fullscreen insets 
  (would break resize)
              // The key insight: if we've done a FULL UPDATE with tiled=false, 
  don't let
              // a late TILED_STATE=true switch us to tiled mode mid-session.
              if (isInputViewShown && newState && !launcherTiledActive &&
  lastCalculatedHeight > 0) {
                  android.util.Log.w(TAG, ">>> TILED_STATE: IGNORED (fullscreen 
  insets active, blocking switch to tiled)")
                  return
              }

              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
                  // Force the system to recompute insets with the new tiled 
  state
                  window?.window?.decorView?.requestLayout()
                  // If switched to fullscreen, set flag to force full update
                  if (wasTransitionToFullscreen && prefAutoResize &&
  prefDockMode) {
                      android.util.Log.w(TAG, ">>> TILED_STATE: Switched to 
  FULLSCREEN, setting forceFullUpdate flag")
                      forceFullUpdate = true
                      updateInputViewHeight()
                  }
              }
          }
      }
  END_OF_UPDATE_BLOCK

❯ /copy 
  ⎿  Copied to clipboard (4109 characters, 71 lines)

❯ heres the log. seems to be workng for full screen apps and whn tiled,     
  usimg top tiledapl okay. for bottom tiled app the issue js with clikkng   
  to focus text causes a lroblem. seems.manual unhidimg keyboard was okay   
  on bottom tiled app. ~/projects/DroidOS main* ⇡ 19s ❯ adb logcat -c &&    
  adb logcat -s DockIME:* 2>&1 | grep -E                                    
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT       
  UPDATE"                                                                   
  02-04 08:03:42.877 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:03:43.291 30268 30268 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 08:03:43.292 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:03:43.293 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:03:43.293 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:03:45.549 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:03:46.074 30268 30268 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:03:52.958 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:03:52.958 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:03:52.966 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:03:52.966 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
  02-04 08:03:53.058 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:03:53.058 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:03:53.058 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:53.058 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:03:53.092 30268 30268 W 
   DockIME : >>> TILED_STATE received: true (was false, inputShown=true)    
  02-04 08:03:53.092 30268 30268 W DockIME : >>> TILED_STATE: IGNORED       
  (fullscreen insets active, blocking switch to tiled)                      
                                       02-04 08:03:53.158 30268 30268 W     
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
  02-04 08:03:53.158 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:03:53.206 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:03:53.207 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:03:53.210 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:53.210 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:03:54.341 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:54.341 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:03:54.407 30268 30268 W 
   DockIME : >>> onComputeInsets: tiled=false, autoResize=true,             
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:03:54.407 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:03:54.532 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:03:54.533 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
  02-04 08:03:54.594 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:54.594 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:03:54.632 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:03:54.633 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:03:54.643 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:03:55.150 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:03:58.331 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:03:58.332 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:03:58.337 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:58.337 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:03:58.409 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:03:58.409 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
  02-04 08:03:58.447 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:58.447 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:03:58.529 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:58.530 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:03:58.539 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:03:58.539 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:03:58.547 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:03:58.547 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:00.023 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:00.539 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:00.543 30268 30268 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:04:02.216 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:02.216 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:02.223 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:02.223 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:02.286 30268 30268 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:02.286 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:02.324 30268 30268 W DockIME : >>> TILED_STATE       
  received: true (was false, inputShown=true)                               
                                                02-04 08:04:02.324 30268    
  30268 W DockIME : >>> TILED_STATE: IGNORED (fullscreen insets active,     
  blocking switch to tiled)                                                 
            02-04 08:04:06.678 30268 30268 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
  02-04 08:04:07.192 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:08.223 30268 30268 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 08:04:08.224 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:04:08.228 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:08.228 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:08.292 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:08.292 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
  02-04 08:04:08.325 30268 30268 W DockIME : >>> TILED_STATE received: true 
   (was false, inputShown=true)                                             
                                  02-04 08:04:08.325 30268 30268 W DockIME  
  : >>> TILED_STATE: IGNORED (fullscreen insets active, blocking switch to  
  tiled)                                                          02-04     
  08:04:08.329 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:08.329 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:08.452 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:08.453 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
  02-04 08:04:08.455 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:08.455 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:04:08.585 30268 30268 W 
   DockIME : >>> onComputeInsets: tiled=false, autoResize=true,             
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:08.585 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:11.012 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:11.012 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:11.037 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:11.037 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:11.066 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:11.067 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:04:11.132 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:11.132 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:12.487 30268 30268 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:04:12.487 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:04:12.490 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:12.490 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:12.586 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:13.062 30268 30268 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:04:17.161 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:17.161 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:04:17.168 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:17.168 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:17.248 30268 30268 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:17.248 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:17.291 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:17.291 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:17.387 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:17.388 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:17.389 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:17.389 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:04:19.052 30268 30268 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
           02-04 08:04:19.053 30268 30268 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
                                                                02-04       
  08:04:19.066 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:19.581 30268 30268 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:04:19.587 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:21.391 30268 30268 W DockIME 
   : >>> TILED_STATE received: true (was false, inputShown=false)           
                                                                   02-04    
  08:04:21.394 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:21.572 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:21.573 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:21.580 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:21.580 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:21.658 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:21.658 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:24.162 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:24.685 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:25.482 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:25.483 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:25.489 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:25.489 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:30.792 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:31.308 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:39.744 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:39.744 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:39.751 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:39.751 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:39.801 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:39.801 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:39.883 30268 30268 W DockIME : >>> TILED_STATE received: true 
   (was false, inputShown=true)                                             
  02-04 08:04:39.883 30268 30268 W DockIME : >>> TILED_STATE: IGNORED       
  (fullscreen insets active, blocking switch to tiled)                      
  02-04 08:04:39.923 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:39.923 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:40.339 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:40.339 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:40.366 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:40.379 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:40.379 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:04:40.380 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:40.380 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:40.452 30268 30268 W DockIME : >>> TILED_STATE       
  received: true (was false, inputShown=true)                               
                                                02-04 08:04:40.452 30268    
  30268 W DockIME : >>> TILED_STATE: IGNORED (fullscreen insets active,     
  blocking switch to tiled)                                                 
  02-04 08:04:43.070 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:43.603 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:43.604 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:44.199 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:44.199 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:44.206 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:44.207 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:44.280 30268 30268 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:04:44.280 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:04:44.281 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:44.281 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:44.401 30268 30268 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=true)                                                   
                            02-04 08:04:44.401 30268 30268 W DockIME : >>>  
  TILED_STATE: IGNORED (fullscreen insets active, blocking switch to tiled) 
                                                            02-04           
  08:04:44.401 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:44.401 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:44.442 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:44.443 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:04:44.443 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:44.443 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:44.533 30268 30268 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:04:45.010 30268 30268 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:04:48.600 30268 30268 D DockIME :                      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:04:48.601 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:04:48.607 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:48.607 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:48.826 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:48.827 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:04:48.830 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:04:48.830 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:04:51.356 30268 30268 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:04:51.870 30268 30268 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:04:52.688 30268 30268 D DockIME :                      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:04:52.689 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:04:52.695 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:52.695 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:52.990 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:04:52.991 30268 30268 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:04:52.993 30268 30268 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:52.993 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:04:54.013 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:54.538 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:54.752 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:04:54.752 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:04:54.759 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:04:54.759 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:04:54.827 30268 30268 W 
   DockIME : >>> onComputeInsets: tiled=false, autoResize=true,             
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:54.827 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:54.869 30268 30268 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=true)                                                   
                            02-04 08:04:54.869 30268 30268 W DockIME : >>>  
  TILED_STATE: IGNORED (fullscreen insets active, blocking switch to tiled) 
                                                            02-04           
  08:04:54.871 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:54.871 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:55.033 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:55.033 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:56.611 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:57.118 30268 30268 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:04:57.124 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:57.843 30268 30268 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 08:04:57.843 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:04:57.850 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:04:57.850 30268 30268 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:04:57.964 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:57.964 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:58.090 30268 30268 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:04:58.090 30268 30268 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:04:58.846 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 08:04:59.363 30268 30268 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:04:59.364 30268 30268 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:05:07.559 30268 30268 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:05:07.560 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:05:07.566 30268 30268 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
  02-04 08:05:07.566 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:05:07.692 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:05:07.692 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:05:07.815 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:05:07.815 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:05:10.180 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:05:10.180 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:05:10.208 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:05:10.209 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:05:10.275 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:05:10.275 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:05:10.317 30268 30268 W DockIME : >>> TILED_STATE       
  received: true (was false, inputShown=false)                              
                                                02-04 08:05:10.319 30268    
  30268 W DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,     
  dockView=true)                                                            
            02-04 08:05:10.831 30268 30268 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 08:05:12.505 30268 30268  
  D DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME          
  Height=603, tiled=false                                                   
           02-04 08:05:12.506 30268 30268 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
  02-04 08:05:12.515 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:05:12.515 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:05:12.768 30268 30268 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:05:12.769 30268 30268 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:05:12.769 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:05:12.770 30268      
  30268 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
  02-04 08:05:12.988 30268 30268 W DockIME : >>> TILED_STATE received: true 
   (was false, inputShown=true)                                             
  02-04 08:05:12.988 30268 30268 W DockIME : >>> TILED_STATE: IGNORED       
  (fullscreen insets active, blocking switch to tiled)                      
  02-04 08:05:13.294 30268 30268 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:05:13.294 30268 30268 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  ^C                                                                        
                  ~/projects/DroidOS main* ⇡ 1m 34s ❯                       

● I see the issue in the logs. The sequence is:
  1. TILED_STATE=true arrives (inputShown=false) → accepted,
  launcherTiledActive=true
  2. onWindowShown resets launcherTiledActive=false ← This overrides the correct
   value!
  3. updateInputViewHeight runs with tiled=false → FULLSCREEN MODE
  4. Next TILED_STATE=true gets IGNORED (fullscreen insets active)

  The fix: Remove the reset in onWindowShown. The TILED_STATE broadcast already
  sets the correct value.

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Remove launcherTiledActive reset in onWindowShown - it overrides
  legitimate TILED_STATE broadcasts
  SEARCH_BLOCK:
      override fun onWindowShown() {
          super.onWindowShown()
          loadDockPrefs()

          // [FIX] Reset to fullscreen by default on every window show.
          // If the app is actually tiled, the TILED_STATE broadcast will arrive
   shortly
          // and override this. This prevents stale tiled=true state from 
  blocking
          // fullscreen app resizing.
          val wasTiled = launcherTiledActive
          launcherTiledActive = false
          forceFullUpdate = wasTiled // Force full update if we were previously 
  tiled

          android.util.Log.w(TAG, ">>> onWindowShown: tiled=$launcherTiledActive
   (was $wasTiled), autoResize=$prefAutoResize, dockMode=$prefDockMode, 
  scale=$prefResizeScale")
  REPLACE_BLOCK:
      override fun onWindowShown() {
          super.onWindowShown()
          loadDockPrefs()

          // Don't reset launcherTiledActive here - the TILED_STATE broadcast 
          // sets the correct value. Resetting would override legitimate 
  broadcasts
          // that arrive just before onWindowShown.
          // The tiledStateReceiver handles blocking invalid state transitions.

          android.util.Log.w(TAG, ">>> onWindowShown: 
  tiled=$launcherTiledActive, autoResize=$prefAutoResize, 
  dockMode=$prefDockMode, scale=$prefResizeScale")
  END_OF_UPDATE_BLOCK

❯ /copy 
  ⎿  Copied to clipboard (2036 characters, 40 lines)

❯ tiled apps woek. but for full screen apps, now manual kb unhide didnt     
  work. ~/projects/DroidOS main ⇡ 40s ❯ adb logcat -c && adb logcat -s      
  DockIME:* 2>&1 | grep -E                                                  
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT       
  UPDATE"                                                                   
  02-04 08:11:34.094 11660 11660 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 08:11:34.094 11660 11660 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
  02-04 08:11:34.105 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:11:34.105 11660 11660 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:11:34.220 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:11:34.220 11660 11660 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:11:37.698 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:11:38.054 11660 11660 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
                                     02-04 08:11:38.054 11660 11660 D       
  DockIME : updateInputViewHeight: SOFT UPDATE (tiled) h=603                
                                                                            
  02-04 08:11:38.055 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:11:38.055 11660 11660 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 08:11:40.403 11660 11660 W       
  DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,             
  dockView=true)                                                            
            02-04 08:11:40.939 11660 11660 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
                                            02-04 08:11:43.162 11660 11660  
  W DockIME : >>> TILED_STATE received: true (was true, inputShown=false)   
                                                                            
   02-04 08:11:44.811 11660 11660 W DockIME : >>> TILED_STATE received:     
  true (was true, inputShown=false)                                         
                                      02-04 08:11:47.441 11660 11660 D      
  DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME            
  Height=603, tiled=true                                                    
           02-04 08:11:47.441 11660 11660 D DockIME :                       
  updateInputViewHeight: SOFT UPDATE (tiled) h=603                          
                                                                02-04       
  08:11:47.449 11660 11660 W DockIME : >>> onComputeInsets: tiled=true,     
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                               02-04 08:11:47.449 11660 11660 W DockIME :   
  >>> onComputeInsets: TILED MODE - suppressing insets (contentTop=628)     
  02-04 08:11:47.511 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 08:11:47.511 11660     
  11660 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 08:11:47.552 11660 11660 W DockIME : >>> onComputeInsets:  
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                02-04 08:11:47.552 11660     
  11660 W DockIME : >>> onComputeInsets: TILED MODE - suppressing insets    
  (contentTop=628)                                                          
           02-04 08:11:47.576 11660 11660 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=true                                                                
  02-04 08:11:47.576 11660 11660 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
                                    02-04 08:11:47.624 11660 11660 W        
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 08:11:47.624 11660 11660 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
  02-04 08:11:47.661 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:11:47.661 11660 11660 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:11:49.834 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:11:49.834 11660 11660 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:11:49.851 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:11:49.851 11660 11660 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:11:49.901 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:11:50.425 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:11:50.426 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:12:00.481 11660 11660 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 08:12:00.481 11660 11660 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
                                    02-04 08:12:00.485 11660 11660 W        
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 08:12:00.485 11660 11660 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
                                                            02-04           
  08:12:00.526 11660 11660 W DockIME : >>> onComputeInsets: tiled=true,     
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                               02-04 08:12:00.526 11660 11660 W DockIME :   
  >>> onComputeInsets: TILED MODE - suppressing insets (contentTop=628)     
                                                                02-04       
  08:12:00.557 11660 11660 W DockIME : >>> onComputeInsets: tiled=true,     
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                               02-04 08:12:00.557 11660 11660 W DockIME :   
  >>> onComputeInsets: TILED MODE - suppressing insets (contentTop=628)     
                                                                02-04       
  08:12:00.568 11660 11660 W DockIME : >>> TILED_STATE received: false (was 
   true, inputShown=true)                                                   
                            02-04 08:12:00.568 11660 11660 W DockIME : >>>  
  TILED_STATE: Switched to FULLSCREEN, setting forceFullUpdate flag         
                                                            02-04           
  08:12:00.568 11660 11660 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:12:00.569 11660 11660 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
  02-04 08:12:00.569 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:12:00.569 11660      
  11660 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:12:01.217 11660 11660 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:12:01.727 11660 11660 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:12:04.604 11660 11660 D DockIME :                      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:12:04.604 11660 11660 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:12:04.612 11660 11660 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:12:04.612 11660 11660 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:12:04.685 11660 11660 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:12:04.685 11660 11660 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
  02-04 08:12:06.478 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:12:06.927 11660 11660 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:12:06.928 11660 11660 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:12:06.929 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:12:06.929 11660 11660 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:12:08.397 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:12:08.925 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:12:12.809 11660 11660 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 08:12:12.809 11660 11660 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:12:12.816 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:12:12.816 11660      
  11660 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:12:14.400 11660 11660 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
  02-04 08:12:14.814 11660 11660 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:12:14.815 11660 11660 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:12:14.816 11660 11660 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:12:14.816 11660      
  11660 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:12:16.956 11660 11660 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:12:17.486 11660 11660 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:12:23.261 11660 11660 W DockIME : >>> TILED_STATE      
  received: false (was false, inputShown=false)                             
                                                02-04 08:12:26.808 11660    
  11660 D DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME    
  Height=603, tiled=false                                                   
           02-04 08:12:26.808 11660 11660 D DockIME :                       
  updateInputViewHeight: FULL UPDATE (setInputView) h=603 fullscreen=true   
  02-04 08:12:26.813 11660 11660 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:12:26.813 11660      
  11660 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:12:29.607 11660 11660 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
  02-04 08:12:30.134 11660 11660 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:12:38.561 11660 11660 W DockIME 
   : >>> TILED_STATE received: false (was false, inputShown=false)          
                                                                   02-04    
  08:12:40.623 11660 11660 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:12:40.624 11660 11660 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:12:40.630 11660 11660 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:12:40.630 11660      
  11660 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:12:40.671 11660 11660 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:12:40.671 11660      
  11660 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           ^C                                                               
  ~/projects/DroidOS main ⇡ 1m 11s ❯                                        

● Looking at the logs, I see the issue. When manually showing the keyboard
  (without focusing a text field), the TILED_STATE broadcast isn't sent, so
  launcherTiledActive keeps its stale value from the previous tiled session.

  The fix: Track when TILED_STATE was last received. If it's stale (more than 1
  second ago) when the window shows, assume fullscreen.

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Track TILED_STATE timestamp to detect stale state on manual keyboard
  show
  SEARCH_BLOCK:
      private var launcherTiledActive = false
      private var forceFullUpdate = false // Flag to force full setInputView() 
  on next update
  REPLACE_BLOCK:
      private var launcherTiledActive = false
      private var forceFullUpdate = false // Flag to force full setInputView() 
  on next update
      private var lastTiledStateTime = 0L // Timestamp of last TILED_STATE 
  broadcast
  END_OF_UPDATE_BLOCK

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Record timestamp when TILED_STATE is received
  SEARCH_BLOCK:
              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
  REPLACE_BLOCK:
              lastTiledStateTime = System.currentTimeMillis()
              if (newState != launcherTiledActive) {
                  val wasTransitionToFullscreen = launcherTiledActive &&
  !newState
                  launcherTiledActive = newState
  END_OF_UPDATE_BLOCK

  FILE_UPDATE: DroidOSKeyboardTrackpad/app/src/main/java/com/katsuyamaki/DroidOS
  TrackpadKeyboard/DockInputMethodService.kt
  REASON: Reset stale tiled state on window show for manual keyboard unhide
  SEARCH_BLOCK:
      override fun onWindowShown() {
          super.onWindowShown()
          loadDockPrefs()

          // Don't reset launcherTiledActive here - the TILED_STATE broadcast 
          // sets the correct value. Resetting would override legitimate 
  broadcasts
          // that arrive just before onWindowShown.
          // The tiledStateReceiver handles blocking invalid state transitions.

          android.util.Log.w(TAG, ">>> onWindowShown: 
  tiled=$launcherTiledActive, autoResize=$prefAutoResize, 
  dockMode=$prefDockMode, scale=$prefResizeScale")
  REPLACE_BLOCK:
      override fun onWindowShown() {
          super.onWindowShown()
          loadDockPrefs()

          // Check if TILED_STATE is stale (more than 1 second old).
          // This handles manual keyboard show where no TILED_STATE is sent.
          // If stale and currently tiled, reset to fullscreen.
          val timeSinceLastState = System.currentTimeMillis() -
  lastTiledStateTime
          if (launcherTiledActive && timeSinceLastState > 1000) {
              android.util.Log.w(TAG, ">>> onWindowShown: TILED_STATE stale 
  (${timeSinceLastState}ms), resetting to fullscreen")
              launcherTiledActive = false
              forceFullUpdate = true
          }

          android.util.Log.w(TAG, ">>> onWindowShown: 
  tiled=$launcherTiledActive, autoResize=$prefAutoResize, 
  dockMode=$prefDockMode, scale=$prefResizeScale")
  END_OF_UPDATE_BLOCK

✻ Cogitated for 36s

❯ /copy 
  ⎿  Copied to clipboard (3312 characters, 70 lines)

❯ didntwoek. i see that tapping bubble launchetk jnhjde/hide actually       
  doesnt even show up jn the logs. ~/projects/DroidOS main* ⇡ 17s ❯ adb     
  logcat -c && adb logcat -s DockIME:* 2>&1 | grep -E                       
  "TILED_STATE|updateInputViewHeight|onComputeInsets|FULL UPDATE|SOFT       
  UPDATE"              02-04 08:16:37.562 28260 28260 W DockIME : >>>       
  onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)            
                                                            02-04           
  08:16:38.081 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:16:46.824 28260 28260 D DockIME 
   : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,       
  tiled=false                                                               
  02-04 08:16:46.824 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:16:46.833 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:16:46.833 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:16:48.905 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:16:49.436 28260 28260 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:17:02.881 28260 28260 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=false)                                                  
                            02-04 08:17:02.882 28260 28260 W DockIME : >>>  
  onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)            
                                                            02-04           
  08:17:06.133 28260 28260 W DockIME : >>> onWindowShown: TILED_STATE stale 
   (3251ms), resetting to fullscreen                                        
                            02-04 08:17:06.143 28260 28260 D DockIME :      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:17:06.143 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:06.151 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:17:06.151 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:17:06.237 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:06.237 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:06.288 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:06.288 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:06.363 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:06.363 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:06.379 28260 28260 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:17:06.379 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:17:06.463 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:06.463 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:09.146 28260 28260 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:09.146 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:09.178 28260 28260 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:17:09.187 28260 28260 D 
   DockIME : updateInputViewHeight: ON. Margin=630, Nav=25 -> IME           
  Height=603, tiled=false                                                   
  02-04 08:17:09.188 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:09.191 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:17:09.191 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:17:09.302 28260 28260 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=true)                                                   
                            02-04 08:17:09.302 28260 28260 W DockIME : >>>  
  TILED_STATE: IGNORED (fullscreen insets active, blocking switch to tiled) 
                                                            02-04           
  08:17:10.854 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:17:11.379 28260 28260 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:17:11.907 28260 28260 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:17:11.908 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:17:11.914 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:11.914 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:11.981 28260 28260 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:11.981 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:12.016 28260 28260 W DockIME : >>> TILED_STATE       
  received: true (was false, inputShown=true)                               
                                                02-04 08:17:12.016 28260    
  28260 W DockIME : >>> TILED_STATE: IGNORED (fullscreen insets active,     
  blocking switch to tiled)                                                 
            02-04 08:17:12.020 28260 28260 W DockIME : >>> onComputeInsets: 
   tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,    
  lastCalcH=603                               02-04 08:17:12.020 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:12.089 28260 28260 D DockIME :                       
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:17:12.089 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:12.322 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:17:12.322 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:17:12.635 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:12.635 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:14.759 28260 28260 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:17:14.760 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:14.768 28260 28260 W        
  DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,             
  dockView=true)                                                            
  02-04 08:17:15.281 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:17:15.288 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:17:17.846 28260 28260 W DockIME : >>> TILED_STATE received: true 
   (was false, inputShown=false)                                            
  02-04 08:17:17.853 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:17:18.029 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 08:17:18.029 28260 28260 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
  02-04 08:17:18.039 28260 28260 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:17:18.039 28260 28260 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:17:18.121 28260 28260 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:17:18.121 28260 28260 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 08:17:18.182 28260 28260 W       
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 08:17:18.183 28260 28260 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
  02-04 08:17:19.564 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:17:20.082 28260 28260 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:17:28.465 28260 28260 W DockIME : >>> onWindowShown: TILED_STATE stale 
   (10619ms), resetting to fullscreen                                       
                            02-04 08:17:28.467 28260 28260 D DockIME :      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:17:28.468 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:28.474 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:17:28.474 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:17:28.553 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:28.553 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:28.588 28260 28260 W DockIME : >>> TILED_STATE received: true (was  
  false, inputShown=true)                                                   
                            02-04 08:17:28.588 28260 28260 W DockIME : >>>  
  TILED_STATE: IGNORED (fullscreen insets active, blocking switch to tiled) 
                                                            02-04           
  08:17:28.593 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:28.593 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:28.731 28260 28260 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:17:28.732 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:17:28.737 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:28.737 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:28.832 28260 28260 W DockIME : >>> onComputeInsets:  
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:17:28.832 28260 28260 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:17:30.912 28260 28260 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:17:31.420 28260 28260 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
  02-04 08:17:31.426 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:17:32.086 28260 28260 W DockIME 
   : >>> TILED_STATE received: true (was false, inputShown=false)           
                                                                   02-04    
  08:17:32.093 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
  02-04 08:17:32.279 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=true                          
  02-04 08:17:32.279 28260 28260 D DockIME : updateInputViewHeight: SOFT    
  UPDATE (tiled) h=603                                                      
  02-04 08:17:32.287 28260 28260 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:17:32.287 28260 28260 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
  02-04 08:17:32.356 28260 28260 W DockIME : >>> onComputeInsets:           
  tiled=true, autoResize=true, dockMode=true, viewH=628, wrapperH=603,      
  lastCalcH=603                                                             
  02-04 08:17:32.356 28260 28260 W DockIME : >>> onComputeInsets: TILED     
  MODE - suppressing insets (contentTop=628)                                
                                     02-04 08:17:32.394 28260 28260 W       
  DockIME : >>> onComputeInsets: tiled=true, autoResize=true,               
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
              02-04 08:17:32.394 28260 28260 W DockIME : >>>                
  onComputeInsets: TILED MODE - suppressing insets (contentTop=628)         
  02-04 08:17:34.277 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:17:34.804 28260 28260 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:17:43.678 28260 28260 W DockIME : >>> onWindowShown: TILED_STATE stale 
   (11592ms), resetting to fullscreen                                       
                            02-04 08:17:43.681 28260 28260 D DockIME :      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:17:43.681 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:43.687 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:17:43.687 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:17:43.798 28260 28260 W DockIME : >>> onComputeInsets: tiled=false,    
  autoResize=true, dockMode=true, viewH=628, wrapperH=603, lastCalcH=603    
                              02-04 08:17:43.798 28260 28260 W DockIME :    
  >>> onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603) 
                                                                02-04       
  08:17:47.521 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:17:48.046 28260 28260 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:17:52.123 28260 28260 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:17:52.123 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:17:52.133 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:52.133 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:17:52.860 28260 28260 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:17:53.372 28260 28260 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            '02-04 08:17:56.588 28260 28260 D DockIME :                     
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:17:56.589 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:17:56.602 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:17:56.602 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            02-04           
  08:17:58.180 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED         
  (inputViewShown=false, dockView=true)                                     
                                   02-04 08:17:58.744 28260 28260 W DockIME 
   : >>> onComputeInsets: SKIPPED (inputViewShown=false, dockView=true)     
                                                                   02-04    
  08:17:59.583 28260 28260 D DockIME : updateInputViewHeight: ON.           
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:17:59.584 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:17:59.596 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:17:59.596 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:18:01.014 28260 28260 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:18:01.993 28260 28260 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
  02-04 08:18:05.444 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:18:05.445 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:18:05.452 28260 28260 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:18:05.452 28260 28260 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:18:09.037 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:18:09.559 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:18:13.670 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:18:13.671 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
  02-04 08:18:13.679 28260 28260 W DockIME : >>> onComputeInsets:           
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:18:13.679 28260 28260 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
  02-04 08:18:16.688 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:18:17.204 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:18:19.986 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:18:19.987 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:18:19.996 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                                                             
  02-04 08:18:19.996 28260 28260 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:18:23.136 28260 28260 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
  02-04 08:18:23.654 28260 28260 W DockIME : >>> onComputeInsets: SKIPPED   
  (inputViewShown=false, dockView=true)                                     
  02-04 08:18:26.313 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
  02-04 08:18:26.313 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:18:26.368 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
  02-04 08:18:26.368 28260 28260 W DockIME : >>> onComputeInsets:           
  FULLSCREEN MODE - using default insets (wrapper=603)                      
                                           02-04 08:18:27.836 28260 28260 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:18:28.350 28260 28260 W DockIME : >>> onComputeInsets: 
   SKIPPED (inputViewShown=false, dockView=true)                            
  02-04 08:18:47.969 28260 28260 D DockIME : updateInputViewHeight: ON.     
  Margin=630, Nav=25 -> IME Height=603, tiled=false                         
                                     02-04 08:18:47.969 28260 28260 D       
  DockIME : updateInputViewHeight: FULL UPDATE (setInputView) h=603         
  fullscreen=true                                                           
        02-04 08:18:47.978 28260 28260 W DockIME : >>> onComputeInsets:     
  tiled=false, autoResize=true, dockMode=true, viewH=628, wrapperH=603,     
  lastCalcH=603                               02-04 08:18:47.979 28260      
  28260 W DockIME : >>> onComputeInsets: FULLSCREEN MODE - using default    
  insets (wrapper=603)                                                      
           02-04 08:18:49.121 28260 28260 W DockIME : >>> onComputeInsets:  
  SKIPPED (inputViewShown=false, dockView=true)                             
                                           02-04 08:18:49.644 28260 28260 W 
   DockIME : >>> onComputeInsets: SKIPPED (inputViewShown=false,            
  dockView=true)                                                            
            02-04 08:18:55.405 28260 28260 D DockIME :                      
  updateInputViewHeight: ON. Margin=630, Nav=25 -> IME Height=603,          
  tiled=false                                                               
  02-04 08:18:55.406 28260 28260 D DockIME : updateInputViewHeight: FULL    
  UPDATE (setInputView) h=603 fullscreen=true                               
                                    02-04 08:18:55.419 28260 28260 W        
  DockIME : >>> onComputeInsets: tiled=false, autoResize=true,              
  dockMode=true, viewH=628, wrapperH=603, lastCalcH=603                     
             02-04 08:18:55.419 28260 28260 W DockIME : >>>                 
  onComputeInsets: FULLSCREEN MODE - using default insets (wrapper=603)     
                                                            ^C              
  ~/projects/DroidOS main* ⇡ 2m 23s ❯                                       

● Looking at the logs, I see the issue. When you tap the bubble to show/hide the
   overlay keyboard, DockIME isn't being shown - only the overlay keyboard is.
  That's why there's no log entry.

  The app resize only happens when DockIME is shown (which reports insets to
  Android). The overlay keyboard is just a visual overlay - it doesn't affect
  app layout.

  For manual bubble tap to resize apps, you have two options:

  1. Enable "Auto-show Overlay KB" in the DockIME popup - this syncs overlay and
   DockIME visibility, so both show/hide together
  2. Make bubble tap also show DockIME - this requires a code change

  Which approach would you prefer? Option 1 is the intended workflow for the
  current design. Option 2 would require changes to OverlayService to
  programmatically show the IME when manually showing the overlay keyboard.

✻ Sautéed for 1m 0s

❯ what do you mean for option 1? i already had this toggle on when i        
  targeted y with the logcat. i also tried to untoggle and toggle again now 
   and nothing changed, still didnt work                                    

● I see - you have "Auto-show Overlay KB" enabled. That toggle only syncs one
  direction: when DockIME shows → overlay shows. But when you manually tap 
  bubble → DockIME doesn't show.

  The issue is that DockIME can only show when Android triggers it (text field
  focus). The overlay keyboard is separate and can't force DockIME to appear.

  Let me add a fix in OverlayService to request the IME to show when manually
  showing the overlay:

● Searched for 1 pattern (ctrl+o to expand)
  ⎿  You've hit your limit · resets 10am (America/New_York)
     /upgrade to increase your usage limit.

✻ Cogitated for 43s

❯ /stats 
  ⎿  Stats dialog dismissed